3069  /********************************************************************************
3069! ************/
3070  /*  RUN TIME:       APPROX 1 HOUR
3070!            */
3071  /********************************************************************************
3071! ************/
3072
3073  %LET DATE = %SYSFUNC(TODAY(),YYMMDDN8.);
3074  %LET LOG_NAME = TI97_STARS_data_pull;
3075  %LET LOG_PATH = H:\navy_fmo\Audit Readiness\SEGMENTS\AD HOC\FY12\ALL\SAS Codes
3075! and Logs;
3076  %LET OUTPATH = H:\navy_fmo\Audit Readiness\SEGMENTS\AD
3076! HOC\FY12\ALL\Outputs\Output_&date..xls;
3077
3078  LIBNAME FL_OCT 'H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q1 FY12
3078! NEW\SAS Datasets';
NOTE: Libname FL_OCT refers to the same physical library as FL_DEC.
NOTE: Libref FL_OCT was successfully assigned as follows:
      Engine:        V9
      Physical Name: H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q1 FY12
      NEW\SAS Datasets
3079  LIBNAME FL_NOV 'H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q1 FY12
3079! NEW\SAS Datasets';
NOTE: Libname FL_NOV refers to the same physical library as FL_OCT.
NOTE: Libref FL_NOV was successfully assigned as follows:
      Engine:        V9
      Physical Name: H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q1 FY12
      NEW\SAS Datasets
3080  LIBNAME FL_DEC 'H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q1 FY12
3080! NEW\SAS Datasets';
NOTE: Libname FL_DEC refers to the same physical library as FL_NOV.
NOTE: Libref FL_DEC was successfully assigned as follows:
      Engine:        V9
      Physical Name: H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q1 FY12
      NEW\SAS Datasets
3081  LIBNAME FL_Q2 'H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q2 FY12
3081! NEW\SAS Datasets';
NOTE: Libref FL_Q2 was successfully assigned as follows:
      Engine:        V9
      Physical Name: H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q2 FY12
      NEW\SAS Datasets
3082  LIBNAME FL_APR 'H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q3 FY12
3082! NEW\SAS Datasets';
NOTE: Libname FL_APR refers to the same physical library as FL_JUN.
NOTE: Libref FL_APR was successfully assigned as follows:
      Engine:        V9
      Physical Name: H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q3 FY12
      NEW\SAS Datasets
3083  LIBNAME FL_MAY 'H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q3 FY12
3083! NEW\SAS Datasets';
NOTE: Libname FL_MAY refers to the same physical library as FL_APR.
NOTE: Libref FL_MAY was successfully assigned as follows:
      Engine:        V9
      Physical Name: H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q3 FY12
      NEW\SAS Datasets
3084  LIBNAME FL_JUN 'H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q3 FY12
3084! NEW\SAS Datasets';
NOTE: Libname FL_JUN refers to the same physical library as FL_MAY.
NOTE: Libref FL_JUN was successfully assigned as follows:
      Engine:        V9
      Physical Name: H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q3 FY12
      NEW\SAS Datasets
3085  LIBNAME FL_Q4 'H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q4_FY12\SAS
3085! Datasets';
NOTE: Libref FL_Q4 was successfully assigned as follows:
      Engine:        V9
      Physical Name: H:\navy_fmo\Audit Readiness\SOURCE DATA\STARS-FL\FY12\Q4_FY12\SAS
      Datasets
3086
3087  *datasets to use
3088  fl_oct
3089  fl_nov
3090  q2_fy12
3091  fl_apr
3092  fl_may
3093  fl_jun
3094  fl_q4fy12_adj
3095
3096
3097  /********************************************************************************
3097! ************/
3098  /* MACRO TO SUMMARIZE DATASET AND PROVIDE CONTROL TOTALS.
3098!            */
3099  /********************************************************************************
3099! ************/;
3100  %MACRO CONTROL_TOTALS(DSN, VAR_LIST);
3101                  PROC SUMMARY DATA=&DSN. NWAY MISSING;
3102                          VAR &VAR_LIST.;
3103                          OUTPUT OUT=SUMM SUM=;
3104                  RUN;
3105                  %LET CNT =
3105! %EVAL(%SYSFUNC(LENGTH(%SYSFUNC(COMPBL("&VAR_LIST."))))-%SYSFUNC(LENGTH(%SYSFUNC(C
3105! OMPRESS("&VAR_LIST."))))+1);
3106                  %PUT "COUNT OF VARIABLES: &CNT.";
3107                  DATA _NULL_;
3108                          SET SUMM;
3109                          FORMAT _FREQ_ COMMA20.;
3110                          FORMAT &VAR_LIST. COMMA30.2;
3111                          PUT @3
3111! '----------------------------------------------------'/;
3112                          PUT @5 "CONTROL TOTAL AND TOTAL NUMBER OF RECORDS IN
3112! &DSN."/;
3113                          PUT @10 'TOTAL NUMBER OF RECORDS = ' _FREQ_/;
3114                          %DO I = 1 %TO &CNT.;
3115                                  %LET VAR = %SCAN(&VAR_LIST.,&I.);
3116                                  PUT @10 "TOTAL OF &VAR. = " &VAR./;
3117                          %END;
3118                          PUT @3
3118! '----------------------------------------------------'/;
3119                  RUN;
3120  %MEND;
3121  /********************************************************************************
3121! ************/
3122  /* MACROS TO EXPORT A DATASET.
3122!                                                                        */
3123  /********************************************************************************
3123! ************/
3124  %MACRO EXPORT_XLS(DATASET);
3125          PROC EXPORT DATA = &DATASET. DBMS = EXCEL
3126                  FILE = "&OUTPATH." REPLACE;
3127                  SHEET = "&DATASET.";
3128          RUN;
3129  %MEND;
3130
3131  %CONTROL_TOTALS(FL_OCT.FL_OCT,AMOUNT_USSGL_FINAL);

NOTE: There were 39646866 observations read from the data set FL_OCT.FL_OCT.
NOTE: The data set WORK.SUMM has 1 observations and 3 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           5:09.16
      cpu time            31.82 seconds


"COUNT OF VARIABLES: 1"

  ----------------------------------------------------

    CONTROL TOTAL AND TOTAL NUMBER OF RECORDS IN FL_OCT.FL_OCT

         TOTAL NUMBER OF RECORDS = 39,646,866

         TOTAL OF AMOUNT_USSGL_FINAL = 94,538,048,824.23

  ----------------------------------------------------
NOTE: There were 1 observations read from the data set WORK.SUMM.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


3132  /*UTILIZE THE STARS-FL OCT, NOV &DEC FY12 POPULATION AND LIMIT TO TRANSACTIONS TO
3132!  CERTAIN LOGIC*/
3133
3134  DATA FL_Q1;
3135      SET FL_OCT.FL_OCT FL_NOV.FL_NOV FL_DEC.FL_DEC;
3136  where APN_SYM='0100' and
3137      APN_BEG_FIS_YR='07' and
3138      GA='97' and
3139      SUBSTR(APN_SBH,1,3)in ('38S' '22S');
3140  RUN;

NOTE: There were 171 observations read from the data set FL_OCT.FL_OCT.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
NOTE: There were 27 observations read from the data set FL_NOV.FL_NOV.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
NOTE: There were 58 observations read from the data set FL_DEC.FL_DEC.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
NOTE: The data set WORK.FL_Q1 has 256 observations and 123 variables.
NOTE: DATA statement used (Total process time):
      real time           14:28.82
      cpu time            1:24.53


NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the
      end of this session.
3141  /*UTILIZE THE STARS-FL Q2 FY12 POPULATION AND LIMIT TO TRANSACTIONS TO CERTAIN
3141! LOGIC*/
3142
3143  DATA FL_Q2;
3144      SET FL_Q2.q2_fy12;
3145  where APN_SYM='0100' and
3146      APN_BEG_FIS_YR='07' and
3147      GA='97' and
3148      SUBSTR(APN_SBH,1,3)in ('38S' '22S');
3149  RUN;

NOTE: There were 253 observations read from the data set FL_Q2.Q2_FY12.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
NOTE: The data set WORK.FL_Q2 has 253 observations and 123 variables.
NOTE: DATA statement used (Total process time):
      real time           10:58.71
      cpu time            1:11.43


3150  /*UTILIZE THE STARS-FL APR, MAY & JUN FY12 POPULATION AND LIMIT TO TRANSACTIONS
3150! TO CERTAIN LOGIC*/
3151
3152  DATA FL_Q3;
3153      SET FL_APR.FL_APR FL_MAY.FL_MAY FL_JUN.FL_JUN;
3154  where APN_SYM='0100' and
3155      APN_BEG_FIS_YR='07' and
3156      GA='97' and
3157      SUBSTR(APN_SBH,1,3)in ('38S' '22S');
3158  RUN;

NOTE: There were 0 observations read from the data set FL_APR.FL_APR.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
NOTE: There were 23 observations read from the data set FL_MAY.FL_MAY.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
NOTE: There were 13 observations read from the data set FL_JUN.FL_JUN.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
NOTE: The data set WORK.FL_Q3 has 36 observations and 123 variables.
NOTE: DATA statement used (Total process time):
      real time           8:38.75
      cpu time            2:01.68


3159
3160
3161
3162  /*UTILIZE THE STARS-FL Q4 FY12 POPULATION AND LIMIT TO TRANSACTIONS TO CERTAIN
3162! LOGIC*/
3163
3164  DATA FL_Q4;
3165      SET FL_Q4.fl_q4fy12_adj;
3166  where APN_SYM='0100'and
                    ------
                    49
NOTE 49-169: The meaning of an identifier after a quoted string may change in a future
             SAS release.  Inserting white space between a quoted string and the
             succeeding identifier is recommended.

3167      APN_BEG_FIS_YR='07' and
3168      GA='97' and
3169      SUBSTR(APN_SBH,1,3)in ('38S' '22S');
3170  RUN;

ERROR: An I/O error has occurred on file FL_Q4.FL_Q4FY12_ADJ.DATA.
NOTE: The data step has been abnormally terminated.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: There were 229 observations read from the data set FL_Q4.FL_Q4FY12_ADJ.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
WARNING: The data set WORK.FL_Q4 may be incomplete.  When this step was stopped there
         were 229 observations and 125 variables.
NOTE: DATA statement used (Total process time):
      real time           4:35.00
      cpu time            36.61 seconds


3171
3172  /********************************************************************************
3172! ************ /*
3173                       EXPORTS                                            */
3174  /********************************************************************************
3174! ************/
3175
3176  %EXPORT_XLS(FL_Q1);

NOTE: New file "H:\navy_fmo\Audit Readiness\SEGMENTS\AD
      HOC\FY12\ALL\Outputs\Output_20130603.xls" will be created if the export process
      succeeds.
NOTE: "FL_Q1" was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           1.42 seconds
      cpu time            0.06 seconds


3177  %EXPORT_XLS(FL_Q2);

NOTE: "FL_Q2" was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.23 seconds
      cpu time            0.06 seconds


3178  %EXPORT_XLS(FL_Q3);

NOTE: "FL_Q3" was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds


3179  %EXPORT_XLS(FL_Q4);

NOTE: "FL_Q4" was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.17 seconds
      cpu time            0.06 seconds


3180
3181
3182  /********************************************************************************
3182! ************/
3183   /*                                       END OF PROGRAM
3183!             */
3184   /*******************************************************************************
3184! *************/
3185    DM "LOG; FILE 'H:\navy_fmo\Audit Readiness\SEGMENTS\AD HOC\FY12\ALL\SAS Codes
3185! and Logs\TI97_STARS_data_pull_&DATE..LOG' REPLACE";
NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the
      end of this session.
ERROR: Invalid Operation.
ERROR: Invalid Operation.
ERROR: Invalid Operation.
ERROR: The value specified for the verticalPosition attribute is not valid. Specify
another value.
Parameters passed to method _SETATTRIBUTEVALUE:
  1 (Character Literal) = 'verticalPosition'
  2 (Numeric Expression $T8) = -1
Program returning prematurely at line 257
AF Program: SASHELP.FSP.VTFRAME.SCL
action = ''
cmd = ''
cmd = ''
cmd = ''
cmd2 = ''
cmd2 = ''
cmd2 = ''
cmd2 = ''
cmd3 = ''
cmdlist = .
cmdlistID = .
command_list = .
dataview_id = .
dataview_id = .
dataview_id = .
entry = ''
entry = ''
fullname = ''
glist = .
group = .
group = .
i = .
i = .
i = .
id = .
index = .
itemlist = .
key = ''
modified = .
mytype = ''
mytype = ''
mytype = ''
name = ''
numcols = .
numrows = .
optnum = .
optnum = .
optnum = .
prevcmd = ''
rc = .
rc = .
rc = .
rc = 0
rc = .
rc = .
slist = .
source = ''
table_view = ''
tcmd = ''
value = ''
viewer_id = .
wtype = ''
_CFRAME_ = 4445
_CURROW_ = .
_ERROR_ = .
_EVENT_ = ''
_FRAME_ = 4445
_METHOD_ = '_TERM'
_MSG_ = ''
_SELF_ = 4445
_STATUS_ = ' '
WARNING: Incomplete termination for SASHELP.FSP.VTMAIN.FRAME: _TERM_ method may not be
         performing a CALL SUPER(_self_, '_TERM_'). FRAME termination forced.
ERROR: Termination due to Floating Point Exception
3186
3187
3188  /*UTILIZE THE STARS-FL Q4 FY12 POPULATION AND LIMIT TO TRANSACTIONS TO CERTAIN
3188! LOGIC*/
3189
3190  DATA FL_Q4;
3191      SET FL_Q4.fl_q4fy12_adj;
3192  where APN_SYM='0100'and
                    ------
                    49
NOTE 49-169: The meaning of an identifier after a quoted string may change in a future
             SAS release.  Inserting white space between a quoted string and the
             succeeding identifier is recommended.

3193      APN_BEG_FIS_YR='07' and
3194      GA='97' and
3195      SUBSTR(APN_SBH,1,3)in ('38S' '22S');
3196  RUN;

NOTE: The data step has been abnormally terminated.
NOTE: There were 30 observations read from the data set FL_Q4.FL_Q4FY12_ADJ.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
WARNING: The data set WORK.FL_Q4 may be incomplete.  When this step was stopped there
         were 30 observations and 125 variables.
WARNING: Data set WORK.FL_Q4 was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           23.65 seconds
      cpu time            0.46 seconds


3197
3198  /********************************************************************************
3198! ************ /*
3199                       EXPORTS                                            */
3207
3208  /********************************************************************************
3208! ************/
3209   /*                                       END OF PROGRAM
3209!             */
3210   /*******************************************************************************
3210! *************/
3211    DM "LOG; FILE 'H:\navy_fmo\Audit Readiness\SEGMENTS\AD HOC\FY12\ALL\SAS Codes
3211! and Logs\TI97_STARS_data_pull_&DATE..LOG' REPLACE";

3212  /*UTILIZE THE STARS-FL Q4 FY12 POPULATION AND LIMIT TO TRANSACTIONS TO CERTAIN
3212! LOGIC*/
3213
3214  DATA FL_Q4;
3215      SET FL_Q4.fl_q4fy12_adj;
3216  where APN_SYM='0100' and
3217      APN_BEG_FIS_YR='07' and
3218      GA='97' and
3219      SUBSTR(APN_SBH,1,3)in ('38S' '22S');
3220  RUN;

NOTE: There were 328 observations read from the data set FL_Q4.FL_Q4FY12_ADJ.
      WHERE (APN_SYM='0100') and (APN_BEG_FIS_YR='07') and (GA='97') and
      SUBSTR(APN_SBH, 1, 3) in ('22S', '38S');
NOTE: The data set WORK.FL_Q4 has 328 observations and 125 variables.
NOTE: DATA statement used (Total process time):
      real time           9:29.78
      cpu time            1:45.23


3221
3222  /********************************************************************************
3222! ************ /*
3223                       EXPORTS                                            */
3224  /********************************************************************************
3224! ************/
3225
3226  %EXPORT_XLS(FL_Q1);

ERROR: Execute: Field cannot be updated.
WARNING: Table _IMEX_."FL_Q1" has not been dropped.
ERROR: Execute: The connection for viewing your linked Microsoft Excel worksheet was
       lost.
WARNING: Table _IMEX_."FL_Q1$" has not been dropped.
ERROR: There was a problem removing the original table FL_Q1.  See Log for details.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           16:07.70
      cpu time            5:18.12

3227  %EXPORT_XLS(FL_Q2);



ERROR: Connect: The Microsoft Jet database engine cannot open the file ''.  It is
       already opened exclusively by another user, or you need permission to view its
       data.
ERROR: Error in the LIBNAME statement.
Connection Failed.  See log for details.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.37 seconds
      cpu time            0.03 seconds

3228  %EXPORT_XLS(FL_Q3);



ERROR: Connect: The Microsoft Jet database engine cannot open the file ''.  It is
       already opened exclusively by another user, or you need permission to view its
       data.
ERROR: Error in the LIBNAME statement.
Connection Failed.  See log for details.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.10 seconds
      cpu time            0.06 seconds

3229  %EXPORT_XLS(FL_Q4);



ERROR: Connect: The Microsoft Jet database engine cannot open the file ''.  It is
       already opened exclusively by another user, or you need permission to view its
       data.
ERROR: Error in the LIBNAME statement.
Connection Failed.  See log for details.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds

3230
3231
3232  /********************************************************************************
3232! ************/
3233   /*                                       END OF PROGRAM
3233!             */
3234   /*******************************************************************************
3234! *************/
3235    DM "LOG; FILE 'H:\navy_fmo\Audit Readiness\SEGMENTS\AD HOC\FY12\ALL\SAS Codes
3235! and Logs\TI97_STARS_data_pull_&DATE..LOG' REPLACE";

3236  %EXPORT_XLS(FL_Q1);

NOTE: "FL_Q1" was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           1.70 seconds
      cpu time            0.73 seconds


3237  %EXPORT_XLS(FL_Q2);

NOTE: "FL_Q2" was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.35 seconds
      cpu time            0.23 seconds


3238  %EXPORT_XLS(FL_Q3);

NOTE: "FL_Q3" was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.32 seconds
      cpu time            0.23 seconds


3239  %EXPORT_XLS(FL_Q4);

NOTE: "FL_Q4" was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.45 seconds
      cpu time            0.34 seconds


3240
3241
